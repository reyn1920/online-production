<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Evolution Agent - AI Content Evolution Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      .evolution-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
      }
      .metric-card {
        background: white;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
        transition: transform 0.3s ease;
      }
      .metric-card:hover {
        transform: translateY(-5px);
      }
      .trend-indicator {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: bold;
      }
      .trend-up {
        background: #d4edda;
        color: #155724;
      }
      .trend-down {
        background: #f8d7da;
        color: #721c24;
      }
      .trend-stable {
        background: #fff3cd;
        color: #856404;
      }
      .format-card {
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        transition: all 0.3s ease;
      }
      .format-card:hover {
        border-color: #667eea;
        box-shadow: 0 2px 10px rgba(102, 126, 234, 0.1);
      }
      .capability-progress {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 0.5rem;
        margin-bottom: 0.5rem;
      }
      .evolution-score {
        font-size: 3rem;
        font-weight: bold;
        color: #667eea;
      }
      .platform-insight {
        background: linear-gradient(45deg, #f8f9fa, #e9ecef);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
      }
      .action-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 25px;
        font-weight: bold;
        transition: all 0.3s ease;
      }
      .action-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        color: white;
      }
      .innovation-badge {
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="evolution-header">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-8">
            <h1>
              <i class="fas fa-dna me-3"></i>
              Evolution Agent
            </h1>
            <p class="mb-0">Autonomous Content Format Evolution & Trend Adaptation</p>
          </div>
          <div class="col-md-4 text-end">
            <div class="evolution-score" id="evolutionScore">8.7</div>
            <small>Evolution Score</small>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <!-- System Status Overview -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="metric-card text-center">
            <i class="fas fa-chart-line fa-2x text-primary mb-2"></i>
            <h4 id="trendsDetected">47</h4>
            <p class="mb-0">Trends Detected</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="metric-card text-center">
            <i class="fas fa-layer-group fa-2x text-success mb-2"></i>
            <h4 id="formatsAnalyzed">23</h4>
            <p class="mb-0">Formats Analyzed</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="metric-card text-center">
            <i class="fas fa-cogs fa-2x text-warning mb-2"></i>
            <h4 id="adaptationsMade">34</h4>
            <p class="mb-0">Adaptations Made</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="metric-card text-center">
            <i class="fas fa-rocket fa-2x text-info mb-2"></i>
            <h4 id="capabilitiesAdded">12</h4>
            <p class="mb-0">New Capabilities</p>
          </div>
        </div>
      </div>

      <!-- Trending Formats -->
      <div class="row mb-4">
        <div class="col-md-8">
          <div class="metric-card">
            <h5>
              <i class="fas fa-fire me-2"></i>
              Trending Formats
            </h5>
            <div id="trendingFormats">
              <!-- Dynamic content will be loaded here -->
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="metric-card">
            <h5>
              <i class="fas fa-brain me-2"></i>
              Innovation Status
            </h5>
            <div class="innovation-badge mb-3">Leading Edge</div>
            <div class="mb-2">
              <small>Adaptation Speed</small>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: 95%"></div>
              </div>
            </div>
            <div class="mb-2">
              <small>Format Accuracy</small>
              <div class="progress">
                <div class="progress-bar bg-info" style="width: 94%"></div>
              </div>
            </div>
            <div class="mb-2">
              <small>Trend Prediction</small>
              <div class="progress">
                <div class="progress-bar bg-warning" style="width: 87%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Platform Insights -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="metric-card">
            <h5>
              <i class="fas fa-globe me-2"></i>
              Platform Insights
            </h5>
            <div class="row" id="platformInsights">
              <!-- Dynamic content will be loaded here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Current Capabilities -->
      <div class="row mb-4">
        <div class="col-md-6">
          <div class="metric-card">
            <h5>
              <i class="fas fa-tools me-2"></i>
              Current Capabilities
            </h5>
            <div id="currentCapabilities">
              <!-- Dynamic content will be loaded here -->
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="metric-card">
            <h5>
              <i class="fas fa-seedling me-2"></i>
              Evolving Capabilities
            </h5>
            <div id="evolvingCapabilities">
              <!-- Dynamic content will be loaded here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Format Adaptation Controls -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="metric-card">
            <h5>
              <i class="fas fa-magic me-2"></i>
              Format Adaptation
            </h5>
            <div class="row">
              <div class="col-md-4">
                <label class="form-label">Format Type</label>
                <select class="form-select" id="formatType">
                  <option value="ai-avatar">AI Avatar Presentations</option>
                  <option value="micro-learning">Micro-Learning Modules</option>
                  <option value="voice-first">Voice-First Content</option>
                  <option value="interactive-stories">Interactive Stories</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label">Adaptation Strategy</label>
                <select class="form-select" id="adaptationStrategy">
                  <option value="gradual">Gradual Implementation</option>
                  <option value="aggressive">Aggressive Rollout</option>
                  <option value="test-first">Test-First Approach</option>
                </select>
              </div>
              <div class="col-md-4 d-flex align-items-end">
                <button class="btn action-button w-100" onclick="initiateAdaptation()">
                  <i class="fas fa-play me-2"></i>
                  Initiate Adaptation
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Algorithm Changes Alert -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="metric-card">
            <h5>
              <i class="fas fa-exclamation-triangle me-2 text-warning"></i>
              Platform Algorithm Changes
            </h5>
            <div id="algorithmChanges">
              <!-- Dynamic content will be loaded here -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>//Load dashboard data
      async function loadDashboardData() {
        try {
          const response = await fetch("/api/evolution/dashboard');
          const data = await response.json();//Update metrics
          document.getElementById('evolutionScore').textContent = data.trend_monitoring.evolution_score;
          document.getElementById('trendsDetected').textContent = data.trend_monitoring.trends_detected;
          document.getElementById('formatsAnalyzed').textContent = data.trend_monitoring.formats_analyzed;
          document.getElementById('adaptationsMade').textContent = data.system_evolution.adaptations_made;
          document.getElementById('capabilitiesAdded').textContent = data.system_evolution.capabilities_added;//Update platform insights
          updatePlatformInsights(data.platform_insights);
        } catch (error) {
          console.error('Error loading dashboard data:', error);
        }
      }//Load trending formats
      async function loadTrendingFormats() {
        try {
          const response = await fetch("/api/evolution/trends');
          const data = await response.json();

          const container = document.getElementById('trendingFormats');
          container.innerHTML = '';

          data.trending_formats.forEach(format => {
            const formatCard = document.createElement('div');
            formatCard.className = 'format-card';
            formatCard.innerHTML = `
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="mb-1">${format.format_name}</h6>
                                <small class="text-muted">${format.platforms.join(', ')}</small>
                            </div>
                            <span class="trend-indicator trend-up">+${format.growth_velocity}%</span>
                        </div>
                        <div class="mt-2">
                            <small><strong>ROI:</strong> ${format.roi_potential} | <strong>Difficulty:</strong> ${format.implementation_difficulty}</small>
                        </div>
                        <div class="mt-1">
                            ${format.trend_signals.map(signal => `<span class="badge bg-light text-dark me-1">${signal.replace('_', ' ')}</span>`).join('')}
                        </div>
                    `;
            container.appendChild(formatCard);
          });//Update algorithm changes
          updateAlgorithmChanges(data.platform_algorithm_changes);
        } catch (error) {
          console.error('Error loading trending formats:', error);
        }
      }//Load capabilities
      async function loadCapabilities() {
        try {
          const response = await fetch("/api/evolution/capabilities');
          const data = await response.json();//Update current capabilities
          const currentContainer = document.getElementById('currentCapabilities');
          currentContainer.innerHTML = '';

          data.current_capabilities.forEach(capability => {
            const capabilityDiv = document.createElement('div');
            capabilityDiv.className = 'capability-progress';
            capabilityDiv.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center">
                            <span><strong>${capability.name}</strong> v${capability.version}</span>
                            <span class="badge ${capability.status === 'active' ? 'bg-success' : 'bg-warning'}">${capability.status}</span>
                        </div>
                    `;
            currentContainer.appendChild(capabilityDiv);
          });//Update evolving capabilities
          const evolvingContainer = document.getElementById('evolvingCapabilities');
          evolvingContainer.innerHTML = '';

          data.evolving_capabilities.forEach(capability => {
            const capabilityDiv = document.createElement('div');
            capabilityDiv.className = 'capability-progress';
            capabilityDiv.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span><strong>${capability.name}</strong></span>
                            <small>${capability.eta}</small>
                        </div>
                        <div class="progress" style="height: 6px;">
                            <div class="progress-bar bg-primary" style="width: ${capability.progress}%"></div>
                        </div>
                        <small class="text-muted">${capability.progress}% complete</small>
                    `;
            evolvingContainer.appendChild(capabilityDiv);
          });
        } catch (error) {
          console.error('Error loading capabilities:', error);
        }
      }//Update platform insights
      function updatePlatformInsights(insights) {
        const container = document.getElementById('platformInsights');
        container.innerHTML = '';

        Object.entries(insights).forEach(([platform, data]) => {
          const platformDiv = document.createElement('div');
          platformDiv.className = 'col-md-4';
          platformDiv.innerHTML = `
                    <div class="platform-insight">
                        <h6 class="text-capitalize">${platform}</h6>
                        <div class="mb-2">
                            <small>Trend Strength</small>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-success" style="width: ${data.trend_strength * 10}%"></div>
                            </div>
                            <small>${data.trend_strength}/10</small>
                        </div>
                        <div>
                            <small>Format Diversity</small>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-info" style="width: ${data.format_diversity * 10}%"></div>
                            </div>
                            <small>${data.format_diversity}/10</small>
                        </div>
                    </div>
                `;
          container.appendChild(platformDiv);
        });
      }//Update algorithm changes
      function updateAlgorithmChanges(changes) {
        const container = document.getElementById('algorithmChanges');
        container.innerHTML = '';

        changes.forEach(change => {
          const changeDiv = document.createElement('div');
          changeDiv.className = 'alert alert-warning';
          changeDiv.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="alert-heading">${change.platform}: ${change.change_type}</h6>
                            <p class="mb-1">Impact Level: <strong>${change.impact_level}</strong></p>
                            <small>Recommended Actions: ${change.recommended_actions.join(', ')}</small>
                        </div>
                        ${change.adaptation_required ? '<span class="badge bg-danger">Action Required</span>' : ''}
                    </div>
                `;
          container.appendChild(changeDiv);
        });
      }//Initiate format adaptation
      async function initiateAdaptation() {
        const formatType = document.getElementById('formatType').value;
        const adaptationStrategy = document.getElementById('adaptationStrategy').value;

        try {
          const response = await fetch("/api/evolution/adapt', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              format_type: formatType,
              adaptation_strategy: adaptationStrategy,
            }),
          });

          const result = await response.json();//Show success message
          const alert = document.createElement('div');
          alert.className = 'alert alert-success alert-dismissible fade show';
          alert.innerHTML = `
                    <strong>Adaptation Initiated!</strong> ${result.format_type} adaptation started with ${result.strategy} strategy.
                    <br><small>Estimated completion: ${result.estimated_completion}</small>
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;

          document.querySelector('.container').insertBefore(alert, document.querySelector('.container').firstChild);//Auto-dismiss after 5 seconds
          setTimeout(() => {
            if (alert.parentNode) {
              alert.remove();
            }
          }, 5000);
        } catch (error) {
          console.error('Error initiating adaptation:', error);
          alert('Error initiating adaptation. Please try again.');
        }
      }//Initialize dashboard
      document.addEventListener('DOMContentLoaded', function () {
        loadDashboardData();
        loadTrendingFormats();
        loadCapabilities();//Refresh data every 30 seconds
        setInterval(() => {
          loadDashboardData();
          loadTrendingFormats();
          loadCapabilities();
        }, 30000);
      });
    </script>
  </body>
</html>
